---
title: "PIX Cash-in"
description: "Receba pagamentos PIX via QR Code dinâmico em sua aplicação"
icon: "qrcode"
---

<Note>
  O PIX Cash-in permite que você receba pagamentos instantâneos através de QR Codes dinâmicos, oferecendo uma experiência rápida e segura para seus clientes.
</Note>

## Visão Geral

<Frame>
  <img src="/images/pix-cash-in-flow.png" alt="Fluxo de PIX Cash-in" />
</Frame>

O fluxo de PIX Cash-in consiste em:

<Steps>
  <Step title="Solicitar QR Code">
    Sua aplicação solicita um QR Code dinâmico à API RelaxPay
  </Step>
  <Step title="Exibir para o cliente">
    O QR Code é exibido para o cliente em seu site ou aplicativo
  </Step>
  <Step title="Cliente efetua pagamento">
    O cliente escaneia o QR Code com seu aplicativo bancário e confirma a transferência
  </Step>
  <Step title="Receber notificação">
    Você recebe uma notificação via webhook quando o pagamento é confirmado
  </Step>
  <Step title="Liberar produto/serviço">
    Sua aplicação processa o pagamento e libera o produto ou serviço
  </Step>
</Steps>

## Criar QR Code PIX

<Card title="Endpoint" icon="code">
  ```
  POST /api/v1/gateway/request-qrcode
  ```
</Card>

### Parâmetros

<Tabs>
  <Tab title="Request">
    <ParamField body="requestNumber" type="string" required>
      Número de identificação do pedido em seu sistema
    </ParamField>
    <ParamField body="dueDate" type="string" required>
      Data de vencimento do QR Code (formato: AAAA-MM-DD)
    </ParamField>
    <ParamField body="amount" type="number" required>
      Valor total da transação em reais
    </ParamField>
    <ParamField body="shippingAmount" type="number">
      Valor do frete (opcional)
    </ParamField>
    <ParamField body="usernameCheckout" type="string">
      Username associado ao checkout (opcional)
    </ParamField>
    <ParamField body="callbackUrl" type="string" required>
      URL para receber notificações de pagamento
    </ParamField>
    <ParamField body="client" type="object">
      Dados do cliente (opcional)
      <Expandable>
        <ParamField body="name" type="string">
          Nome completo do cliente
        </ParamField>
        <ParamField body="taxId" type="string">
          CPF/CNPJ do cliente
        </ParamField>
        <ParamField body="email" type="string">
          Email do cliente
        </ParamField>
      </Expandable>
    </ParamField>
    <ParamField body="split" type="object">
      Configuração de split de pagamento (opcional)
      <Expandable>
        <ParamField body="username" type="string" required>
          Username do beneficiário do split
        </ParamField>
        <ParamField body="percentageSplit" type="number" required>
          Percentual destinado ao beneficiário (1-100)
        </ParamField>
      </Expandable>
    </ParamField>
  </Tab>
  <Tab title="Response">
    <ResponseField name="idTransaction" type="string">
      Identificador único da transação na RelaxPay
    </ResponseField>
    <ResponseField name="paymentCode" type="string">
      Código PIX copia e cola para pagamento
    </ResponseField>
    <ResponseField name="response" type="string">
      Status da requisição (OK, ERROR)
    </ResponseField>
    <ResponseField name="paymentCodeBase64" type="string">
      Imagem do QR Code em formato base64
    </ResponseField>
  </Tab>
</Tabs>

### Exemplo

<CodeGroup>
  <Code title="Request" active>
    ```json
    {
      "requestNumber": "PEDIDO-12345",
      "dueDate": "2024-07-30",
      "amount": 300.00,
      "usernameCheckout": "checkout",
      "callbackUrl": "https://sua-loja.com/webhook/relaxpay",
      "client": {
        "name": "Maria Silva",
        "taxId": "123.456.789-00",
        "email": "maria@email.com"
      },
      "split": {
        "username": "parceiro-abc",
        "percentageSplit": 10
      }
    }
    ```
  </Code>
  <Code title="Response">
    ```json
    {
      "idTransaction": "0b935d10-3c90-4af3-8776-dd18622a7941",
      "paymentCode": "00020101021226890014br.gov.bcb.pix2567brcode-h.sandbox.starkinfra.com/v2/2b625b826e2f40d29e0b71fbc78904795204000053039865802BR5918Suit Business Ltda6007Goiania62070503***6304F01C",
      "response": "OK",
      "paymentCodeBase64": "iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6AQAAAACgl2eQAAACvElEQVR4Xu2YS3IDIQxE4SLS/W+Ro8BFIP0Ey3Zmkcoi7tVQznzguaojtQTltn8fX+06cxk3cMYNnHEDZ/wNGK311aJFrmg5Wug6mTQCU585F7Nd98jJQ837AF6X/kZE5MjReSvGCigwXRFLyK2olWAzoKsitJQhUXvkY9IHwETHORKaC4E1aQTw57yOq6uv6/8MMBby0DUkUdWTj3kXMMgQRh3c1zEu/jUCahvRWvSVco3KZi494h8joGmStUIq64beiJdpDYDyAxTcqo80GbcK2QegSfFRvBpORZ8qZ7NuAypZ1CwiFR8lTcs0Eh8wcCv1QsomnpFn86i0AUqLOkaypSZPpO2azQ8DuIP+gWWraCdf4OMDpsxSsVocMRSma/EaAL3RNdRClDDZhGtgICtQQnmvopXK6mpvIj8OKEWdRiaTlLrAvPjZCGCNUXlaukhepSxeIi0Ae9kjS42czcraM1kGgBhpRqII2GRPCQrJCRApBaq00kd4QqgVKL8EXpG2UDPZ9ZBWoJGaaiKvB33JCExCo+RsdpYK0Cr7PkUagI1nU7MTlPpprVAnQGLKKatXyVC3KDUC0iSzPMqHchGFe58iDQB5qmUmVULYh3RZAdXJY0/TeZd4VQ29J+vjwNz1y4BOWAoZvVzfyHPkswEQhAdZi4KZ1c2iG4HTvGvmnLY2p5z3/+LzAAUj53aaFzHDMT+K1wEE5TpJUKu15IyxX8VrADAK+lQ52HVTw50acgKtVNHNsxYhaWRGgBQhSGv0Dh2xuiL2mqzPAwzWAuOwraZci2AjMDBJI1mjwrV4m7RWH6CAlLRzxlND1eb6Q6QDKG0UDnLl4dFL90ukCWBrnZvKUd2iupq6F0h+I5GwWYV0OrkTgDnidFNDlXsrbkaAzKCSTIkeCpkYatoH/DZu4IwbOOMGzvgH4BsdZlJNTX5BEAAAAABJRU5ErkJggg=="
    }
    ```
  </Code>
  <Code title="cURL">
    ```bash
    curl -X POST https://ws.relaxpay.site/api/v1/gateway/request-qrcode \
      -H "ci: seu-client-id" \
      -H "cs: seu-client-secret" \
      -H "Content-Type: application/json" \
      -d '{
        "requestNumber": "PEDIDO-12345",
        "dueDate": "2024-07-30",
        "amount": 300.00,
        "callbackUrl": "https://sua-loja.com/webhook/relaxpay"
      }'
    ```
  </Code>
  <Code title="JavaScript">
    ```javascript
    const response = await fetch('https://ws.relaxpay.site/api/v1/gateway/request-qrcode', {
      method: 'POST',
      headers: {
        'ci': 'seu-client-id',
        'cs': 'seu-client-secret',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        requestNumber: 'PEDIDO-12345',
        dueDate: '2024-07-30',
        amount: 300.00,
        callbackUrl: 'https://sua-loja.com/webhook/relaxpay'
      })
    });
    
    const data = await response.json();
    console.log(data);
    ```
  </Code>
  <Code title="PHP">
    ```php
    $ch = curl_init();
    
    curl_setopt_array($ch, [
      CURLOPT_URL => 'https://ws.relaxpay.site/api/v1/gateway/request-qrcode',
      CURLOPT_RETURNTRANSFER => true,
      CURLOPT_POST => true,
      CURLOPT_HTTPHEADER => [
        'ci: seu-client-id',
        'cs: seu-client-secret',
        'Content-Type: application/json'
      ],
      CURLOPT_POSTFIELDS => json_encode([
        'requestNumber' => 'PEDIDO-12345',
        'dueDate' => '2024-07-30',
        'amount' => 300.00,
        'callbackUrl' => 'https://sua-loja.com/webhook/relaxpay'
      ])
    ]);
    
    $response = curl_exec($ch);
    $data = json_decode($response, true);
    ```
  </Code>
</CodeGroup>

## Teste ao Vivo

<Frame>
  <div style={{ padding: '20px', borderRadius: '8px', backgroundColor: '#f9f9f9' }}>
    <h3>Crie um QR Code PIX</h3>
    <p>Gere um QR Code de teste para ver como funciona</p>
  </div>
</Frame>

<ParamField path="valor" type="number" required>
  Valor em R$ (mínimo: R$ 1,00)
</ParamField>

<ParamField path="descricao" type="string">
  Descrição (opcional)
</ParamField>

<Button>Gerar QR Code</Button>

## Notificações de Pagamento

Quando um pagamento for recebido, enviaremos uma notificação para a URL de callback informada no momento da criação do QR Code.

<AccordionGroup>
  <Accordion title="Pagamento Recebido" icon="check-circle">
    <ResponseField name="event" type="string">
      payment.received
    </ResponseField>
    
    ```json
    {
      "event": "payment.received",
      "data": {
        "idTransaction": "0b935d10-3c90-4af3-8776-dd18622a7941",
        "typeTransaction": "PIX",
        "statusTransaction": "PAID_OUT",
        "value": 300.00,
        "payerName": "João Silva",
        "payerTaxId": "123.456.789-00",
        "paymentDate": "20/03/2024 15:30:45"
      }
    }
    ```
  </Accordion>
  <Accordion title="Estorno Recebido" icon="undo">
    <ResponseField name="event" type="string">
      payment.refunded
    </ResponseField>
    
    ```json
    {
      "event": "payment.refunded",
      "data": {
        "idTransaction": "0b935d10-3c90-4af3-8776-dd18622a7941",
        "typeTransaction": "PIX",
        "statusTransaction": "CHARGEBACK",
        "value": 300.00,
        "refundReason": "Cliente solicitou estorno",
        "refundDate": "21/03/2024 09:15:22"
      }
    }
    ```
  </Accordion>
  <Accordion title="QR Code Expirado" icon="clock">
    <ResponseField name="event" type="string">
      payment.expired
    </ResponseField>
    
    ```json
    {
      "event": "payment.expired",
      "data": {
        "idTransaction": "0b935d10-3c90-4af3-8776-dd18622a7941",
        "typeTransaction": "PIX",
        "statusTransaction": "EXPIRED",
        "value": 300.00,
        "expiryDate": "30/07/2024 23:59:59"
      }
    }
    ```
  </Accordion>
</AccordionGroup>

## Status das Transações

<CardGroup cols={3}>
  <Card title="PAID_OUT" icon="circle-check" color="#4CAF50">
    Pagamento confirmado com sucesso, já está disponível em seu saldo.
  </Card>
  <Card title="CHARGEBACK" icon="arrow-rotate-left" color="#F44336">
    Pagamento estornado ou devolvido ao pagador.
  </Card>
  <Card title="EXPIRED" icon="hourglass-end" color="#FFC107">
    QR Code expirou sem que o pagamento fosse realizado.
  </Card>
</CardGroup>

## Integração Passo a Passo

<Steps>
  <Step title="Configure seu webhook">
    Crie um endpoint em sua aplicação para receber as notificações de pagamento:
    ```javascript
    // Exemplo em Express.js
    app.post('/webhook/relaxpay', express.json(), (req, res) => {
      const { event, data } = req.body;
      
      // Validar a assinatura do webhook
      if (!validarAssinaturaWebhook(req)) {
        return res.status(401).send('Assinatura inválida');
      }
      
      // Processar o evento
      if (event === 'payment.received') {
        // Atualizar status do pedido para pago
        atualizarStatusPedido(data.idTransaction, 'PAGO');
        
        // Liberar produto/serviço
        liberarProduto(data.idTransaction);
      }
      
      // Confirmar recebimento
      res.status(200).send('OK');
    });
    ```
  </Step>
  <Step title="Gere o QR Code">
    No momento do checkout, solicite um QR Code PIX para o cliente:
    ```javascript
    async function gerarQRCodePIX(pedido) {
      const response = await fetch('https://ws.relaxpay.site/api/v1/gateway/request-qrcode', {
        method: 'POST',
        headers: {
          'ci': process.env.RELAXPAY_CLIENT_ID,
          'cs': process.env.RELAXPAY_CLIENT_SECRET,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          requestNumber: pedido.numero,
          dueDate: pedido.dataVencimento,
          amount: pedido.valorTotal,
          callbackUrl: 'https://sua-loja.com/webhook/relaxpay',
          client: {
            name: pedido.cliente.nome,
            taxId: pedido.cliente.cpf,
            email: pedido.cliente.email
          }
        })
      });
      
      return await response.json();
    }
    ```
  </Step>
  <Step title="Exiba para seu cliente">
    Mostre o QR Code e o código copia e cola para o cliente:
    ```html
    <div class="qrcode-container">
      <h3>Pague com PIX</h3>
      <img src="data:image/png;base64,${qrCodeBase64}" alt="QR Code PIX">
      <div class="copia-cola">
        <p>Ou copie o código abaixo:</p>
        <input type="text" value="${codigoPix}" readonly>
        <button onclick="copiarCodigo()">Copiar</button>
      </div>
      <p class="expiry">Válido até: ${dataVencimento}</p>
    </div>
    ```
  </Step>
  <Step title="Processe o pagamento">
    Ao receber a notificação de pagamento, atualize o status do pedido e libere o produto ou serviço:
    ```javascript
    function atualizarStatusPedido(idTransacao, status) {
      // Buscar pedido pelo ID da transação
      const pedido = buscarPedidoPorTransacao(idTransacao);
      
      if (pedido) {
        // Atualizar status no banco de dados
        atualizarPedidoNoBanco(pedido.id, status);
        
        // Enviar confirmação para o cliente
        enviarEmailConfirmacao(pedido.cliente.email, {
          numeroPedido: pedido.numero,
          valorPago: pedido.valorTotal,
          dataPagamento: new Date()
        });
      }
    }
    ```
  </Step>
</Steps>

## Boas Práticas

<Check>
  **Validação de Pagamento**: Sempre confirme o valor recebido antes de liberar produtos
</Check>
<Check>
  **Armazenamento Seguro**: Guarde os IDs de transação para referência futura
</Check>
<Check>
  **Implementação Idempotente**: Garanta que o mesmo pagamento não será processado múltiplas vezes
</Check>
<Check>
  **Timeout Adequado**: Configure um tempo limite adequado para expiração do QR Code
</Check>
<Check>
  **Logs Detalhados**: Mantenha registros de todas as transações e eventos relacionados
</Check>

<Warning>
  Sempre valide a assinatura dos webhooks antes de processar o pagamento e liberar o produto ou serviço.
</Warning>

## Solução de Problemas

<ResponseField name="400 - Bad Request" type="error">
  Há problemas nos parâmetros enviados na requisição. Verifique se todos os campos obrigatórios estão corretos.
</ResponseField>

<ResponseField name="401 - Unauthorized" type="error">
  Credenciais inválidas. Verifique seu Client ID e Client Secret.
</ResponseField>

<ResponseField name="429 - Too Many Requests" type="warning">
  Limite de requisições excedido. Aguarde alguns minutos e tente novamente.
</ResponseField>

<ResponseField name="500 - Internal Server Error" type="error">
  Erro interno do servidor. Entre em contato com o suporte técnico.
</ResponseField>

<Tip>
  QR Codes não utilizados expiram automaticamente conforme a data de vencimento definida. Para testes, recomendamos usar datas de vencimento curtas (1-2 dias).
</Tip> 